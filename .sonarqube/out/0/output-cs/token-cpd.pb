¸
TC:\Users\jpabl\Desktop\AppWeb\BackComentarios\BackComentarios\AplicationDbContext.cs
	namespace 	
BackComentarios
 
{ 
public 

class 
AplicationDbContext $
:$ %
	DbContext& /
{ 
public 
DbSet 
< 

Comentario 
>  

comentario! +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public

 
AplicationDbContext

 "
(

" #
DbContextOptions

# 3
<

3 4
AplicationDbContext

4 G
>

G H
options

H O
)

O P
:

P Q
base

Q U
(

U V
options

V ]
)

] ^
{ 	
} 	
} 
} ¬6
aC:\Users\jpabl\Desktop\AppWeb\BackComentarios\BackComentarios\Controllers\ComentarioController.cs
	namespace 	
BackComentarios
 
. 
Controllers %
{ 
[		 
Route		 

(		
 
$str		 
)		 
]		 
[

 
ApiController

 
]

 
public 

class  
ComentarioController %
:& '
ControllerBase( 6
{ 
private 
readonly 
AplicationDbContext ,
_context- 5
;5 6
public  
ComentarioController #
(# $
AplicationDbContext$ 7
context8 ?
)? @
{ 	
_context 
= 
context 
; 
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
Get) ,
(, -
)- .
{ 	
try 
{ 
var 
listComentarios #
=$ %
await& +
_context, 4
.4 5

comentario5 ?
.? @
ToListAsync@ K
(K L
)L M
;M N
return 
Ok 
( 
listComentarios )
)) *
;* +
} 
catch   
(   
	Exception   
ex   
)    
{"" 
return## 

BadRequest## !
(##! "
ex##" $
.##$ %
Message##% ,
)##, -
;##- .
}$$ 
}%% 	
[(( 	
HttpGet((	 
((( 
$str(( 
)(( 
](( 
public)) 
async)) 
Task)) 
<)) 
IActionResult)) '
>))' (
Get))) ,
()), -
int))- 0
id))1 3
)))3 4
{** 	
try++ 
{,, 
var-- 

comentario-- 
=--  
await--! &
_context--' /
.--/ 0

comentario--0 :
.--: ;
	FindAsync--; D
(--D E
id--E G
)--G H
;--H I
if// 
(// 

comentario// 
==//  
null//! %
)//% &
{00 
return11 
NotFound11 #
(11# $
)11$ %
;11% &
}22 
return33 
Ok33 
(33 

comentario33 $
)33$ %
;33% &
}44 
catch55 
(55 
	Exception55 
ex55 
)55  
{77 
return88 

BadRequest88 !
(88! "
ex88" $
.88$ %
Message88% ,
)88, -
;88- .
}99 
}:: 	
[== 	
HttpPost==	 
]== 
public>> 
async>> 
Task>> 
<>> 
IActionResult>> '
>>>' (
Post>>) -
(>>- .
[>>. /
FromBody>>/ 7
]>>7 8

Comentario>>9 C

comentario>>D N
)>>N O
{?? 	
try@@ 
{AA 
_contextBB 
.BB 
AddBB 
(BB 

comentarioBB '
)BB' (
;BB( )
awaitCC 
_contextCC 
.CC 
SaveChangesAsyncCC /
(CC/ 0
)CC0 1
;CC1 2
returnEE 
OkEE 
(EE 

comentarioEE (
)EE( )
;EE) *
}GG 
catchHH 
(HH 
	ExceptionHH 
exHH 
)HH  
{JJ 
returnKK 

BadRequestKK !
(KK! "
exKK" $
.KK$ %
MessageKK% ,
)KK, -
;KK- .
}LL 
}MM 	
[PP 	
HttpPutPP	 
(PP 
$strPP 
)PP 
]PP 
publicQQ 
asyncQQ 
TaskQQ 
<QQ 
IActionResultQQ '
>QQ' (
PutQQ) ,
(QQ, -
intQQ- 0
idQQ1 3
,QQ3 4
[QQ5 6
FromBodyQQ6 >
]QQ> ?

ComentarioQQ@ J

comentarioQQK U
)QQU V
{RR 	
trySS 
{TT 
ifUU 
(UU 
idUU 
!=UU 

comentarioUU #
.UU# $
IdUU$ &
)UU& '
{VV 
returnWW 

BadRequestWW %
(WW% &
)WW& '
;WW' (
}XX 
_contextYY 
.YY 
UpdateYY 
(YY  

comentarioYY  *
)YY* +
;YY+ ,
awaitZZ 
_contextZZ 
.ZZ 
SaveChangesAsyncZZ /
(ZZ/ 0
)ZZ0 1
;ZZ1 2
return[[ 
Ok[[ 
([[ 
new[[ 
{[[ 
message[[ %
=[[& '
$str[[( J
}[[J K
)[[K L
;[[L M
}\\ 
catch]] 
(]] 
	Exception]] 
ex]] 
)]]  
{__ 
return`` 

BadRequest`` !
(``! "
ex``" $
.``$ %
Message``% ,
)``, -
;``- .
}aa 
}bb 	
[ee 	

HttpDeleteee	 
(ee 
$stree 
)ee 
]ee 
publicff 
asyncff 
Taskff 
<ff 
IActionResultff '
>ff' (
Deleteff) /
(ff/ 0
intff0 3
idff4 6
)ff6 7
{gg 	
tryhh 
{ii 
varjj 

comentariojj 
=jj  
awaitjj! &
_contextjj' /
.jj/ 0

comentariojj0 :
.jj: ;
	FindAsyncjj; D
(jjD E
idjjE G
)jjG H
;jjH I
ifll 
(ll 

comentarioll 
==ll !
nullll" &
)ll& '
{mm 
returnnn 
NotFoundnn #
(nn# $
)nn$ %
;nn% &
}oo 
_contextpp 
.pp 

comentariopp #
.pp# $
Removepp$ *
(pp* +

comentariopp+ 5
)pp5 6
;pp6 7
awaitqq 
_contextqq 
.qq 
SaveChangesAsyncqq /
(qq/ 0
)qq0 1
;qq1 2
returnrr 
Okrr 
(rr 
newrr 
{rr 
messagerr  '
=rr( )
$strrr* J
}rrK L
)rrL M
;rrM N
}ss 
catchtt 
(tt 
	Exceptiontt 
extt 
)tt  
{vv 
returnww 

BadRequestww !
(ww! "
exww" $
.ww$ %
Messageww% ,
)ww, -
;ww- .
}xx 
}yy 	
}zz 
}|| Æ
aC:\Users\jpabl\Desktop\AppWeb\BackComentarios\BackComentarios\Migrations\20221106220324_v1.0.0.cs
	namespace 	
BackComentarios
 
. 

Migrations $
{ 
public		 

partial		 
class		 
v100		 
:		 
	Migration		  )
{

 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str "
," #
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 :
,: ;
nullable< D
:D E
falseF K
)K L
. 

Annotation #
(# $
$str$ D
,D E)
NpgsqlValueGenerationStrategyF c
.c d#
IdentityByDefaultColumnd {
){ |
,| }
Titulo 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
type2 6
:6 7
$str8 >
,> ?
nullable@ H
:H I
falseJ O
)O P
,P Q
Creador 
= 
table #
.# $
Column$ *
<* +
string+ 1
>1 2
(2 3
type3 7
:7 8
$str9 ?
,? @
nullableA I
:I J
falseK P
)P Q
,Q R
Texto 
= 
table !
.! "
Column" (
<( )
string) /
>/ 0
(0 1
type1 5
:5 6
$str7 =
,= >
nullable? G
:G H
falseI N
)N O
,O P
FechaCreacion !
=" #
table$ )
.) *
Column* 0
<0 1
DateTime1 9
>9 :
(: ;
type; ?
:? @
$strA [
,[ \
nullable] e
:e f
falseg l
)l m
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 4
,4 5
x6 7
=>8 :
x; <
.< =
Id= ?
)? @
;@ A
} 
) 
; 
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder   
.   
	DropTable   &
(  & '
name!! 
:!! 
$str!! "
)!!" #
;!!# $
}"" 	
}## 
}$$ ô	
RC:\Users\jpabl\Desktop\AppWeb\BackComentarios\BackComentarios\Models\Comentario.cs
	namespace 	
BackComentarios
 
. 
Models  
{ 
public 

class 

Comentario 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[ 	
Required	 
] 
public		 
string		 
Titulo		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
[

 	
Required

	 
]

 
public 
string 
Creador 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
Required	 
] 
public 
string 
Texto 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
Required	 
] 
public 
DateTime 
FechaCreacion %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
} 
} ¡
HC:\Users\jpabl\Desktop\AppWeb\BackComentarios\BackComentarios\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
var 
startup 
= 
new 
Startup 
( 
builder !
.! "
Configuration" /
)/ 0
;0 1
startup		 
.		 
ConfigureServices		 
(		 
builder		 !
.		! "
Services		" *
)		* +
;		+ ,
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
startup 
. 
	Configure 
( 
app 
, 
app 
. 
Lifetime #
)# $
;$ %
if 
( 
app 
. 
Environment 
. 
IsDevelopment !
(! "
)" #
)# $
{ 
app 
. 

UseSwagger 
( 
) 
; 
app 
. 
UseSwaggerUI 
( 
) 
; 
} 
app 
. 
UseHttpsRedirection 
( 
) 
; 
app 
. 
UseAuthorization 
( 
) 
; 
app!! 
.!! 
MapControllers!! 
(!! 
)!! 
;!! 
app## 
.## 
Run## 
(## 
)## 	
;##	 
ª
HC:\Users\jpabl\Desktop\AppWeb\BackComentarios\BackComentarios\Startup.cs
	namespace 	
BackComentarios
 
{ 
public 

class 
Startup 
{ 
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public		 
Startup		 
(		 
IConfiguration		 %
configuration		& 3
)		3 4
{

 	
this 
. 
Configuration 
=  
configuration! .
;. /
} 	
public 
void 
ConfigureServices %
(% &
IServiceCollection& 8
services9 A
)A B
{ 	
string  
PostgresqlConnection '
=( )
Configuration* 7
.7 8
GetConnectionString8 K
(K L
$strL _
)_ `
;` a
services 
. 
AddDbContext !
<! "
AplicationDbContext" 5
>5 6
(6 7
options7 >
=>? A
options 
. 
	UseNpgsql 
( 
Configuration +
.+ ,
GetConnectionString, ?
(? @
$str@ S
)S T
)T U
)U V
;V W
} 	
public 
void 
	Configure 
( 
IApplicationBuilder 1
app2 5
,5 6$
IHostApplicationLifetime7 O
lifetimeP X
)X Y
{ 	
} 	
} 
} 